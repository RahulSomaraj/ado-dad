<?xml version="1.0" encoding="UTF-8"?>
<testsuites name="jest tests" tests="17" failures="4" errors="0" time="48.916">
  <testsuite name="Users API (e2e)" errors="0" failures="4" skipped="0" timestamp="2025-08-31T10:45:16" time="48.776" tests="17">
    <testcase classname="Users API (e2e) › POST /users (create)" name="creates a user (201, response shape)" time="0.421">
    </testcase>
    <testcase classname="Users API (e2e) › POST /users (create)" name="validates email/phone/password (400)" time="0.021">
    </testcase>
    <testcase classname="Users API (e2e) › POST /users/with-profile-picture (multipart)" name="accepts valid image upload" time="0.027">
      <failure>Error: expect(received).toContain(expected) // indexOf

Expected value: 400
Received array: [200, 201]
    at Object.&lt;anonymous&gt; (C:\personal\personal\ado-dad-repo\ado-dad\test\users.e2e-spec.ts:157:26)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)</failure>
    </testcase>
    <testcase classname="Users API (e2e) › POST /users/with-profile-picture (multipart)" name="rejects invalid file type/oversize" time="0.013">
    </testcase>
    <testcase classname="Users API (e2e) › GET /users (list)" name="requires admin roles (401/403)" time="0.206">
    </testcase>
    <testcase classname="Users API (e2e) › GET /users (list)" name="returns paginated list with filters/sort when admin" time="0.119">
    </testcase>
    <testcase classname="Users API (e2e) › GET /users (list)" name="basic caching behavior (repeat same query)" time="0.17">
    </testcase>
    <testcase classname="Users API (e2e) › GET /users/:id" name="returns 200 for existing (admin) and 404 for missing" time="0.392">
    </testcase>
    <testcase classname="Users API (e2e) › GET /users/:id" name="cache invalidation after update" time="0.61">
    </testcase>
    <testcase classname="Users API (e2e) › PUT /users/:id (update)" name="allows self-update for normal user" time="0.19">
    </testcase>
    <testcase classname="Users API (e2e) › PUT /users/:id (update)" name="rejects unauthorized update to another user (403)" time="0.055">
    </testcase>
    <testcase classname="Users API (e2e) › PATCH /users/:id/password" name="requires admin by decorator (normal user likely 403)" time="0.051">
    </testcase>
    <testcase classname="Users API (e2e) › PATCH /users/:id/password" name="admin can change target user password" time="0.251">
    </testcase>
    <testcase classname="Users API (e2e) › DELETE /users/:id" name="soft-deletes user and invalidates caches" time="0.336">
    </testcase>
    <testcase classname="Users API (e2e) › OTP endpoints" name="send-otp works for admin and enforces rate limit" time="24.772">
      <failure>Error: expect(received).toContain(expected) // indexOf

Expected value: 500
Received array: [200]
    at Object.&lt;anonymous&gt; (C:\personal\personal\ado-dad-repo\ado-dad\test\users.e2e-spec.ts:342:12)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
----
    at C:\personal\personal\ado-dad-repo\ado-dad\test\users.e2e-spec.ts:342:40
    at C:\personal\personal\ado-dad-repo\ado-dad\node_modules\supertest\lib\test.js:308:13
    at Test._assertFunction (C:\personal\personal\ado-dad-repo\ado-dad\node_modules\supertest\lib\test.js:285:13)
    at Test.assert (C:\personal\personal\ado-dad-repo\ado-dad\node_modules\supertest\lib\test.js:164:23)
    at Server.localAssert (C:\personal\personal\ado-dad-repo\ado-dad\node_modules\supertest\lib\test.js:120:14)
    at Object.onceWrapper (node:events:638:28)
    at Server.emit (node:events:536:35)
    at emitCloseNT (node:net:2344:8)
    at processTicksAndRejections (node:internal/process/task_queues:81:21)</failure>
    </testcase>
    <testcase classname="Users API (e2e) › OTP endpoints" name="verify-otp handles success/failure" time="2.521">
      <failure>Error: expected 200 &quot;OK&quot;, got 500 &quot;Internal Server Error&quot;
    at Object.&lt;anonymous&gt; (C:\personal\personal\ado-dad-repo\ado-dad\test\users.e2e-spec.ts:361:10)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
----
    at Test._assertStatus (C:\personal\personal\ado-dad-repo\ado-dad\node_modules\supertest\lib\test.js:252:14)
    at C:\personal\personal\ado-dad-repo\ado-dad\node_modules\supertest\lib\test.js:308:13
    at Test._assertFunction (C:\personal\personal\ado-dad-repo\ado-dad\node_modules\supertest\lib\test.js:285:13)
    at Test.assert (C:\personal\personal\ado-dad-repo\ado-dad\node_modules\supertest\lib\test.js:164:23)
    at Server.localAssert (C:\personal\personal\ado-dad-repo\ado-dad\node_modules\supertest\lib\test.js:120:14)
    at Object.onceWrapper (node:events:638:28)
    at Server.emit (node:events:536:35)
    at emitCloseNT (node:net:2344:8)
    at processTicksAndRejections (node:internal/process/task_queues:81:21)</failure>
    </testcase>
    <testcase classname="Users API (e2e) › POST /users/profile-picture" name="updates profile picture for authenticated user" time="1.016">
      <failure>Error: expect(received).toContain(expected) // indexOf

Expected value: 400
Received array: [200, 401, 403]
    at Object.&lt;anonymous&gt; (C:\personal\personal\ado-dad-repo\ado-dad\test\users.e2e-spec.ts:412:10)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
----
    at C:\personal\personal\ado-dad-repo\ado-dad\test\users.e2e-spec.ts:412:48
    at C:\personal\personal\ado-dad-repo\ado-dad\node_modules\supertest\lib\test.js:308:13
    at Test._assertFunction (C:\personal\personal\ado-dad-repo\ado-dad\node_modules\supertest\lib\test.js:285:13)
    at Test.assert (C:\personal\personal\ado-dad-repo\ado-dad\node_modules\supertest\lib\test.js:164:23)
    at Server.localAssert (C:\personal\personal\ado-dad-repo\ado-dad\node_modules\supertest\lib\test.js:120:14)
    at Object.onceWrapper (node:events:638:28)
    at Server.emit (node:events:536:35)
    at emitCloseNT (node:net:2344:8)
    at processTicksAndRejections (node:internal/process/task_queues:81:21)</failure>
    </testcase>
  </testsuite>
</testsuites>